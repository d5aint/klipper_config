[gcode_macro MCU_TIMING_INSTALL]
description: Modify the mcu.py file and Restart
gcode:
    RESPOND MSG="Applying MCU Timing Hack..."
    RUN_SHELL_COMMAND CMD=mcu_timing_cfg PARAMS=install
    RESPOND MSG="Restarting Klipper to apply changes..."
    G4 P1000 ; Wait 1 second to let the shell command finish writing output
    FIRMWARE_RESTART

[gcode_macro MCU_TIMING_REMOVE]
description: Restore original mcu.py and Restart
gcode:
    RESPOND MSG="Restoring MCU Timing defaults..."
    RUN_SHELL_COMMAND CMD=mcu_timing_cfg PARAMS=remove
    RESPOND MSG="Restarting Klipper..."
    G4 P1000
    FIRMWARE_RESTART

[gcode_macro MCU_TIMING_UPDATE]
description: Restore, Git Pull, and Re-Modify
gcode:
    RESPOND MSG="Updating Klipper and preserving Timing Hack..."
    RUN_SHELL_COMMAND CMD=mcu_timing_cfg PARAMS=update
    RESPOND MSG="Update complete. Please restart Klipper manually if required."

[gcode_macro MCU_TIMING_CHECK]
description: Check if mcu.py file has been modified
gcode:
    RUN_SHELL_COMMAND CMD=mcu_timing_cfg PARAMS=check
